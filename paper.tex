\documentclass[a4paper,openany,twoside]{ctexbook}
%\usepackage{ctex}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{extarrows}
%\usepackage{ctexcap}
\usepackage[super]{cite}
\usepackage{pdfpages}


%On Mac OS
\graphicspath{{pic/}}
%\setkeys{Gin}{width=0.8\textwidth,height=50mm}


%链接设置
\usepackage[CJKbookmarks=true,pagebackref,colorlinks]{hyperref}
%版面设置
% ==========================================================
\usepackage[top=5mm,text={140mm,247mm},includehead]{geometry}
%\usepackage[top=5mm,includehead]{geometry}
%\linespread{1.6667}
\usepackage{setspace}
\doublespacing

%标题设置
% ==========================================================
\CTEXsetup[name={,},number={\arabic{chapter}},format={\raggedright},beforeskip={-7mm},afterskip={17pt}]{chapter}
\CTEXsetup[format={\Large\bf},beforeskip={13pt},afterskip={13pt}]{section}

%图表标题格式
\usepackage[labelfont=bf,labelsep=quad]{caption}
%\DeclareCaptionFont{kai}{\kaishu}
%\captionsetup{textfont=kai}

\usepackage{longtable}
\usepackage{tabularx}
\usepackage{booktabs}

%\usepackage{float}
\usepackage{floatrow}
\setcounter{totalnumber}{5}
\setcounter{bottomnumber}{3}
\setcounter{topnumber}{3}

%页眉页脚设置
% ==========================================================
\usepackage{fancyhdr}
\usepackage{xcolor}
\headheight      15mm             % 页眉高
\headsep         10mm              % 页眉距离
\fancypagestyle{plain}{\fancyhf{}%
\fancyhead[OC]{\color{gray}\fangsong 北京科技大学硕士学位论文}%
\fancyhead[EC]{\color{gray}\fangsong 基于时空折中算法的密码分析研究与实现}%
\fancyfoot[C]{\color{gray}- \thepage~-}
%\fancyfoot[C]{\thepage}
\renewcommand{\headrule}{\color{gray}\hrule width\headwidth}}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[OC]{\color{gray}\fangsong 北京科技大学硕士学位论文}
\fancyhead[EC]{\color{gray}\fangsong 基于时空折中算法的密码分析研究与实现}
\fancyfoot[C]{\color{gray}- \thepage~-}
\renewcommand{\headrule}{\color{gray}\hrule width\headwidth}
%\renewcommand{\headrulewidth}{0.4pt}
%\renewcommand{\footruleskip}{0mm}

\usepackage{listings}
\lstset{
language=C++,
%行号
numbers=left,
%背景框
framexleftmargin=10mm,
frame=none,
%背景色
%backgroundcolor=\color[rgb]{1,1,0.76},
backgroundcolor=\color[RGB]{245,245,244},
%样式
basicstyle=\ttfamily\small,
keywordstyle=\bf\color{blue},
identifierstyle=\bf,
numberstyle=\color[RGB]{0,192,192},
commentstyle=\it\color[RGB]{0,96,96},
stringstyle=\rmfamily\slshape\color[RGB]{128,0,0},
%显示空格
showstringspaces=false
}
% ===========================================================
\begin{document}
\includepdfmerge{cover.pdf,1,3,5,7}
\pagenumbering{Roman}
\include{thanks}
\include{abstract}
\include{contents}
\include{chapter1}
\include{chapter2}
\include{chapter3}
\include{chapter4}
\include{chapter5}
\include{chapter6}
%Reference
%\bibliographystyle{plain} \bibliography{reference}
\bibliographystyle{unsrt} \bibliography{reference}
\nocite{*}
\addcontentsline{toc}{chapter}{参考文献} 
\include{appendix}
\includepdfmerge{55.pdf,1}
\includepdfmerge{57.pdf,1}
\end{document}

